<!DOCTYPE html>
<html lang="en">
<head>
<script>
  MathJax = { 
    tex: {
		    inlineMath: [['$','$'], ['\\(','\\)']]
	} }
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<meta name="generator" content="plasTeX" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dependent random choice</title>
<link rel="next" href="sect0004.html" title="Finite field model" />
<link rel="prev" href="sect0002.html" title="Unbalancing" />
<link rel="up" href="index.html" title="LeanAPAP" />
<link rel="stylesheet" href="styles/theme-blue.css" />
<link rel="stylesheet" href="styles/amsthm.css" />
<link rel="stylesheet" href="styles/showmore.css" />
<link rel="stylesheet" href="styles/stylecours.css" />
</head>

<body>
<header>
<svg  id="toc-toggle" class="icon icon-list-numbered "><use xlink:href="symbol-defs.svg#icon-list-numbered"></use></svg>
<h1 id="doc_title"><a href="index.html">LeanAPAP</a></h1>
</header>

<div class="wrapper">
<nav class="toc">
<ul class="sub-toc-0">
<li class="">
  <a href="chap-ap.html"><span class="toc_ref">1</span> <span class="toc_entry">Almost-Periodicity</span></a>
 </li>
<li class="">
  <a href="sect0001.html"><span class="toc_ref">2</span> <span class="toc_entry">Chang’s lemma</span></a>
 </li>
<li class="">
  <a href="sect0002.html"><span class="toc_ref">3</span> <span class="toc_entry">Unbalancing</span></a>
 </li>
<li class=" active current">
  <a href="sect0003.html"><span class="toc_ref">4</span> <span class="toc_entry">Dependent random choice</span></a>
 </li>
<li class="">
  <a href="sect0004.html"><span class="toc_ref">5</span> <span class="toc_entry">Finite field model</span></a>
 </li>
<li ><a href="dep_graph_document.html">Dependency graph</a></li>
</ul>
</nav>

<div class="content">
<div class="content-wrapper">


<div class="main-text">
<h1 id="a0000000004">4 Dependent random choice</h1>
<p><div class="lemma_thmwrapper" id="drc">
  <div class="lemma_thmheading">
    <span class="lemma_thmcaption">
    Lemma
    </span>
    <span class="lemma_thmlabel">4.1</span>
    ✓
    <div class="thm_icons">
    <a class="icon proof" href="sect0003.html#drc">#</a>
    <a class="icon proof" href="sect0003.html#a0000000091"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    <button class="modal lean">L∃∀N</button>
    <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
                <ul class="uses">
          <li><a href="https://github.com/YaelDillies/LeanAPAP//blob/a6cdc492992775e1f557181f9ccdb5a8ea69bb7d/src/physics/drc.lean#L94">drc</a></li>
        </ul>

      </div>
    </div>

  </div>
  </div>
  <div class="lemma_thmcontent">
  <p>  Let \(p\geq 2\) be an even integer. Let \(B_1,B_2\subseteq G\) and \(\mu =\mu _{B_1}\circ \mu _{B_2}\). For any finite set \(A\subseteq G\) and function \(f:G\to \mathbb {R}_{\geq 0}\) there exist \(A_1\subseteq B_1\) and \(A_2\subseteq B_2\) such that </p>
<div class="displaymath" id="a0000000092">
  \[ \langle \mu _{A_1}\circ \mu _{A_2}, f\rangle \lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^p\leq 2\langle (1_{A}\circ 1_{A})^p,f\rangle _\mu  \]
</div>
<p> and </p>
<div class="displaymath" id="a0000000093">
  \[ \min \left( \frac{\left\lvert A_1\right\rvert }{\left\lvert B_1\right\rvert },\frac{\left\lvert A_2\right\rvert }{\left\lvert B_2\right\rvert }\right)\geq \frac{1}{4}\left\lvert A\right\rvert ^{-2p}\lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^{2p}. \]
</div>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000091">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▼</span>
  </div>
  <div class="proof_content">
  <p>First note that the statement is trivially true (with \(A_1=B_1\) and \(A_2=B_2\), say) if \(\lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^p=0\). We can therefore assume this is \(\neq 0\). </p>
<p>For \(s\in G^{p}\) let \(A_1(s)=B_1\cap (A+s_1)\cap \cdots \cap (A+s_{p})\), and similarly for \(A_2(s)\). Note that </p>
<div class="displaymath" id="a0000000094">
  \begin{align*}  \langle (1_{A}\circ 1_{A})^p, f\rangle _\mu & =\sum _{x} \mu _{B_1}\circ \mu _{B_2}(x)(1_{A}\circ 1_{A}(x))^pf(x)\\ & =\sum _{b_1,b_2}\mu _{B_1}(b_1)\mu _{B_2}(b_2)1_{A}\circ 1_{A}(b_1-b_2)^{p}f(b_1-b_2)\\ & =\sum _{b_1,b_2}\mu _{B_1}(b_1)\mu _{B_2}(b_2)\left( \sum _{t\in G}1_{A+t}(b_1)1_{A+t}(b_2)\right)^{p}f(b_1-b_2)\\ & =\sum _{b_1,b_2}\mu _{B_1}(b_1)\mu _{B_2}(b_2)\sum _{s\in G^p}1_{A_1(s)}(b_1)1_{A_2(s)}(b_2)f(b_1-b_2)\\ & =\left\lvert B_1\right\rvert ^{-1}\left\lvert B_2\right\rvert ^{-1}\sum _{s\in G^p}\langle 1_{A_1(s)}\circ 1_{A_2(s)}, f\rangle . \end{align*}
</div>
<p> In particular, applying this with \(f\equiv 1\) we see that </p>
<div class="displaymath" id="a0000000095">
  \[ \lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^p=\left\lvert B_1\right\rvert ^{-1}\left\lvert B_2\right\rvert ^{-1}\sum _s\left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert  \]
</div>
<p> and </p>
<div class="displaymath" id="a0000000096">
  \[ \frac{\langle (1_{A}\circ 1_{A})^p,f\rangle _\mu }{\lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^p}=\frac{\sum _{s}\langle 1_{A_1(s)}\circ 1_{A_2(s)}, f\rangle }{\sum _s \left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert }=\eta , \]
</div>
<p> say. Let \(M{\gt}0\) be some parameter, and let </p>
<div class="displaymath" id="a0000000097">
  \[ g(s) = \begin{cases}  1& \textrm{ if }0{\lt}\left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert {\lt}M^2\textrm{ and }\\ 0& \textrm{ otherwise.}\end{cases} \]
</div>
<p> Then we have </p>
<div class="displaymath" id="a0000000098">
  \[ \sum _s g(s)\left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert  {\lt}\sum _s M\left\lvert A_1(s)\right\rvert ^{1/2}\left\lvert A_2(s)\right\rvert ^{1/2}. \]
</div>
<p> To see why, note first that each summand on the left-hand side is \(\leq \) the corresponding summand on the right-hand side, arguing by cases on whether \(g(s)=1\) or not. It therefore suffices to show that there exists some \(s\) such that the summand on the left-hand side is \({\lt}\) the corresponding summand on the right-hand side. </p>
<p>If \(g(s)=0\) for all \(s\) then choose some \(s\) such that \(\left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert \geq M^2\) (this must exist or else \(\left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert =0\) for all \(s\), but then \(\lVert 1_A\circ 1_A\rVert _{p(\mu )}^p=0\) by the above calculation). Otherwise, choose some \(s\) such that \(g(s)=1\), and note that for this \(s\) we have, by definition of \(s\), </p>
<div class="displaymath" id="a0000000099">
  \[ \left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert {\lt}M\left\lvert A_1(s)\right\rvert ^{1/2}\left\lvert A_2(s)\right\rvert ^{1/2}. \]
</div>
<p>We now choose </p>
<div class="displaymath" id="a0000000100">
  \[ M=\tfrac {1}{2}\left\lvert A\right\rvert ^{-p}(\left\lvert B_1\right\rvert \left\lvert B_2\right\rvert )^{1/2}\lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^p, \]
</div>
<p> so that, by the Cauchy-Schwarz inequality, </p>
<div class="displaymath" id="a0000000101">
  \begin{align*}  \sum _s g(s)\left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert  & {\lt} M \sum _s \left\lvert A_1(s)\right\rvert ^{1/2}\left\lvert A_2(s)\right\rvert ^{1/2}\\ & \leq M\left( \sum _s \sum _{x\in G}1_{A_1(s)}(x)\right)^{1/2}\left( \sum _s \sum _{x\in G}1_{A_2(s)}(x)\right)^{1/2}\\ & = M\left\lvert A\right\rvert ^p(\left\lvert B_1\right\rvert \left\lvert B_2\right\rvert )^{1/2}\\ & =\frac{1}{2}\sum _s \left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert  \end{align*}
</div>
<p> and so </p>
<div class="displaymath" id="a0000000102">
  \[  \sum _s (1-g(s))\left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert  {\gt} \frac{1}{2}\sum _s \left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert  \]
</div>
<p> whence </p>
<div class="displaymath" id="a0000000103">
  \[ \sum _s\langle 1_{A_1(s)}\circ 1_{A_2(s)},f\rangle =\eta \sum \left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert  {\lt} 2\eta \sum _s \left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert (1-g(s)). \]
</div>
<p> In particular there must exist some \(s\) such that </p>
<div class="displaymath" id="a0000000104">
  \[ \langle 1_{A_1(s)}\circ 1_{A_2(s)},f\rangle {\lt} 2\eta \left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert (1-g(s)). \]
</div>
<p> We claim this \(s\) meets the requirements. The first is satisfied since the right-hand side is \(\leq 2\eta \left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert \). The second is satisfied since the left-hand side is trivially \(\geq 0\) and hence such an \(s\) must satisfy \(g(s)=0\), whence either \( \left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert \geq M^2\), that is, </p>
<div class="displaymath" id="a0000000105">
  \[ \left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert \geq \frac{1}{4}\left\lvert A\right\rvert ^{-2p}\left\lvert B_1\right\rvert \left\lvert B_2\right\rvert \lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^{2p}, \]
</div>
<p> or \(\left\lvert A_1(s)\right\rvert \left\lvert A_2(s)\right\rvert =0\), which can’t happen because then the right-hand side is \(=0\). </p>
<p>The final bound now follows since \(xy \leq \min (x,y)\) when \(x,y\leq 1\). </p>

  </div>
</div>
<p><div class="lemma_thmwrapper" id="sift">
  <div class="lemma_thmheading">
    <span class="lemma_thmcaption">
    Lemma
    </span>
    <span class="lemma_thmlabel">4.2</span>
    ✓
    <div class="thm_icons">
    <a class="icon proof" href="sect0003.html#sift">#</a>
    <a class="icon proof" href="sect0003.html#a0000000106"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    <button class="modal lean">L∃∀N</button>
    <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
                <ul class="uses">
          <li><a href="https://github.com/YaelDillies/LeanAPAP//blob/a6cdc492992775e1f557181f9ccdb5a8ea69bb7d/src/physics/drc.lean#L197">sifting</a></li>
        </ul>

      </div>
    </div>

  </div>
  </div>
  <div class="lemma_thmcontent">
  <p>  Let \(\epsilon ,\delta {\gt}0\) and \(p\geq \max (2,\epsilon ^{-1}\log (2/\delta ))\) be an even integer. Let \(B_1,B_2\subseteq G\), and let \(\mu =\mu _{B_1}\circ \mu _{B_2}\). For any finite set \(A\subseteq G\), if </p>
<div class="displaymath" id="a0000000107">
  \[ S=\{  x\in G: 1_{A}\circ 1_{A}(x){\gt}(1-\epsilon )\lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}\} , \]
</div>
<p> then there are \(A_1\subseteq B_1\) and \(A_2\subseteq B_2\) such that </p>
<div class="displaymath" id="a0000000108">
  \[ \langle \mu _{A_1}\circ \mu _{A_2},1_{S}\rangle \geq 1-\delta  \]
</div>
<p> and </p>
<div class="displaymath" id="a0000000109">
  \[ \min \left( \frac{\left\lvert A_1\right\rvert }{\left\lvert B_1\right\rvert },\frac{\left\lvert A_2\right\rvert }{\left\lvert B_2\right\rvert }\right)\geq \frac{1}{4}\left\lvert A\right\rvert ^{-2p}\lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^{2p}. \]
</div>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000106">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▼</span>
  </div>
  <div class="proof_content">
  <p> Apply Lemma&#160;<a href="sect0003.html#drc">4.1</a> with \(f=1_{G\backslash S}\). This produces some \(A_1\subseteq B_1\) and \(A_2\subseteq B_2\) such that </p>
<div class="displaymath" id="a0000000110">
  \[ \langle \mu _{A_1}\circ \mu _{A_2}, 1_{G\backslash S}\rangle \leq 2\frac{\langle (1_{A}\circ 1_{A})^p,1_{G\backslash S}\rangle _\mu }{\lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^p} \]
</div>
<p> and </p>
<div class="displaymath" id="a0000000111">
  \[ \min \left( \frac{\left\lvert A_1\right\rvert }{\left\lvert B_1\right\rvert },\frac{\left\lvert A_2\right\rvert }{\left\lvert B_2\right\rvert }\right)\geq \frac{1}{4}\left\lvert A\right\rvert ^{-2p}\lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^{2p}. \]
</div>
<p> It then suffices to note that </p>
<div class="displaymath" id="a0000000112">
  \[ \langle \mu _{A_1}\circ \mu _{A_2},1_{S}\rangle =1-\langle \mu _{A_1}\circ \mu _{A_2},1_{G\backslash S}\rangle  \]
</div>
<p> and by definition of \(S\) we have </p>
<div class="displaymath" id="a0000000113">
  \[ \langle (1_{A}\circ 1_{A})^p,1_{G\backslash S}\rangle _\mu \leq (1-\epsilon )^p\lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^p\sum _{x}\mu (x)=(1-\epsilon )^p\lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^p. \]
</div>
<p> Now use the fact that \(p\geq \epsilon ^{-1}\log (2/\delta )\) together with the inequality \(1-x\leq e^{-x}\) to deduce that the right-hand side is \(\leq \tfrac {\delta }{2}\lVert 1_{A}\circ 1_{A}\rVert _{p(\mu )}^p\). </p>

  </div>
</div>
<p><div class="corollary_thmwrapper" id="sift_cor">
  <div class="corollary_thmheading">
    <span class="corollary_thmcaption">
    Corollary
    </span>
    <span class="corollary_thmlabel">4.3</span>
    ✓
    <div class="thm_icons">
    <a class="icon proof" href="sect0003.html#sift_cor">#</a>
    <a class="icon proof" href="sect0003.html#a0000000114"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    <button class="modal lean">L∃∀N</button>
    <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
                <ul class="uses">
          <li><a href="https://github.com/YaelDillies/LeanAPAP//blob/a6cdc492992775e1f557181f9ccdb5a8ea69bb7d/src/physics/drc.lean#L257">sifting_cor</a></li>
        </ul>

      </div>
    </div>

  </div>
  </div>
  <div class="corollary_thmcontent">
  <p>  Let \(\epsilon ,\delta {\gt}0\) and \(p\geq \max (2,\epsilon ^{-1}\log (2/\delta ))\) be an even integer and \(\mu \equiv 1/N\). If \(A\subseteq G\) has density \(\alpha \) and </p>
<div class="displaymath" id="a0000000115">
  \[ S = \{  x : \mu _A\circ \mu _A(x) \geq (1-\epsilon )\|  \mu _A\circ \mu _A\| _{p(\mu )}\}  \]
</div>
<p> then there are \(A_1,A_2\subseteq G\) such that </p>
<div class="displaymath" id="a0000000116">
  \[ \langle \mu _{A_1}\circ \mu _{A_2}, 1_S\rangle \geq 1-\delta  \]
</div>
<p> and both \(A_1\) and \(A_2\) have density </p>
<div class="displaymath" id="a0000000117">
  \[ \geq \frac{1}{4}\alpha ^{2p}. \]
</div>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000114">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▼</span>
  </div>
  <div class="proof_content">
  <p> We apply Lemma&#160;<a href="sect0003.html#sift">4.2</a> with \(B_1=B_2=G\). It remains to note that </p>
<div class="displaymath" id="a0000000118">
  \[ \|  1_A\circ 1_A\| _{p(\mu )}\geq \|  1_A\circ 1_A\| _{1(\mu )}=\lvert A\rvert ^2/N. \]
</div>

  </div>
</div>

</div> <!--main-text -->
</div> <!-- content-wrapper -->
</div> <!-- content -->
</div> <!-- wrapper -->

<nav class="prev_up_next">
  <svg  id="showmore-minus" class="icon icon-eye-minus showmore"><use xlink:href="symbol-defs.svg#icon-eye-minus"></use></svg>

  <svg  id="showmore-plus" class="icon icon-eye-plus showmore"><use xlink:href="symbol-defs.svg#icon-eye-plus"></use></svg>

  <a href="sect0002.html" title="Unbalancing"><svg  class="icon icon-arrow-left "><use xlink:href="symbol-defs.svg#icon-arrow-left"></use></svg>
</a>
  <a href="index.html" title="LeanAPAP"><svg  class="icon icon-arrow-up "><use xlink:href="symbol-defs.svg#icon-arrow-up"></use></svg>
</a>
  <a href="sect0004.html" title="Finite field model"><svg  class="icon icon-arrow-right "><use xlink:href="symbol-defs.svg#icon-arrow-right"></use></svg>
</a>
</nav>

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/plastex.js"></script>
<script type="text/javascript" src="js/svgxuse.js"></script>
<script type="text/javascript" src="js/js.cookie.min.js"></script>
<script type="text/javascript" src="js/showmore.js"></script>
</body>
</html>